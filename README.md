1. Общая характеристика проекта

Проект представляет собой консольный инструмент, реализованный на языке Python, предназначенный для анализа, построения и визуализации графа зависимостей программных пакетов. Разработка выполняется поэтапно: каждый этап оформлен в отдельном исполняемом модуле (stage1.py–stage5.py) и последовательно расширяет функциональность предыдущего.
Основное назначение системы — моделирование базовой работы менеджера пакетов без использования сторонних библиотек и встроенных средств анализа зависимостей. В качестве источников данных используются файлы тестового репозитория либо параметризуемые URL. Функциональность охватывает разбор зависимостей, проверку корректности структуры, построение графа, выполнение алгоритмов обхода, обработку циклов, фильтрацию узлов и создание визуальных представлений графа, включая ASCII-дерево и D2-диаграммы.


2. Архитектурный подход
Система построена модульно: каждый этап реализует строго ограниченный функциональный блок. Такой подход обеспечивает прозрачность, независимость этапов и удобство тестирования.

2.1. Этапное разделение
 • Stage 1 – обработка параметров командной строки, проверка ошибок, отображение конфигурации.
 • Stage 2 – загрузка и разбор данных о зависимостях, вывод прямых зависимостей.
 • Stage 3 – построение графа зависимостей с использованием BFS, поддержка глубины и фильтрации.
 • Stage 4 – добавление алгоритмов поиска обратных зависимостей.
 • Stage 5 – генерация визуализаций в формате D2 и ASCII-дерева.

Каждый этап имеет собственный файл и может быть выполнен независимо, что соответствует требованиям задания.

3. Используемый формат данных

В тестовом режиме применяется текстовый файл вида:

A: B C
B: D
C: D E
D:
E: F
F:

Особенности данного формата:
 • имя пакета располагается до двоеточия,
 • зависимости перечисляются через пробел,
 • допускаются пустые строки,
 • допускается наличие пакетов-узлов без зависимостей.

Система обрабатывает ошибки: неверный синтаксис, пропуск двоеточия, пустые имена, неверные символы.

4. Этап 1. Конфигурация и параметры запуска

Модуль stage1.py реализует:
 • обработку параметров командной строки,
 • проверку корректности переданных значений,
 • демонстрацию всех параметров в формате ключ=значение.

Поддерживаются параметры:
 • --package — имя корневого пакета,
 • --repo — путь к файлу тестового репозитория,
 • --use-test-repo — активация тестового режима,
 • --ascii — вывод в формате ASCII-дерева,
 • --max-depth — ограничение глубины,
 • --filter — исключение пакетов по подстроке.

Все ошибки параметров демонстрируются явно: некорректные значения, отсутствие обязательных ключей, конфликтующие режимы.

Этап предназначен для проверки корректности конфигурации проекта.

5. Этап 2. Загрузка и разбор данных

Файл stage2.py:
 • открывает переданный тестовый репозиторий,
 • построчно считывает его содержимое,
 • разбирает зависимости,
 • формирует словарь имя_пакета → список зависимостей,
 • выводит все прямые зависимости указанного пользователем пакета.

Реализована валидация:
 • отсутствующие пакеты,
 • некорректные строки,
 • повторное объявление пакета,
 • пустые имена пакетов,
 • циклические ссылки внутри одной строки.

При обнаружении ошибки модуль выдаёт диагностическое сообщение и завершает работу.

6. Этап 3. Построение графа зависимостей

Файл stage3.py реализует ключевую функциональность:

6.1. BFS c рекурсией

Алгоритм строит граф зависимостей, посещая узлы в ширину, но используя рекурсивные вызовы для обхода вложенных уровней. Это сочетание позволяет контролировать:
 • глубину обхода,
 • фильтрацию пакетов,
 • обработку циклических зависимостей.
 Циклы выявляются по таблице посещённых пакетов. При обнаружении цикла программа корректно прекращает углубление в этот путь, не завершаясь аварийно.

6.2. Ограничение глубины

Пользователь задаёт --max-depth.
Например, глубина 2 для:

A → B → C → D

даст дерево:

A
 └─ B
     └─ C


7. Этап 4. Обратные зависимости

Пакетный граф двунаправленный: кроме прямых зависимостей есть и обратные — пакеты, которым требуется данный целевой пакет.

В модуле stage4.py реализована:
 • генерация обратного графа,
 • поиск всех узлов, которые зависят от целевого,
 • вывод результата в структурированном виде.

Алгоритм использует модификацию обхода из Stage 3 — с теми же правилами глубины и фильтрации.

8. Этап 5. Визуализация

Файл stage5.py отвечает за графическое представление данных.

8.1. Формирование диаграммы D2

Генерируется текстовый файл:

A -> B
A -> C
C -> E

Этот формат читает любой визуализатор диаграмм D2 (веб, локальный d2cli, онлайн-рендеры).

8.2. ASCII-дерево

При задании параметра --ascii строится человекочитаемое дерево:

A
 ├─ B
 │   └─ D
 └─ C
     ├─ D
     └─ E

Это удобный формат для консольного анализа зависимостей.


9. Запуск проекта (macOS, PyCharm, Terminal)

9.1. Структура папки

config2/
    stage1.py
    stage2.py
    stage3.py
    stage4.py
    stage5.py
    repo.txt

9.2. Примеры запуска

Stage 1

python3 config2/stage1.py --package A --repo config2/repo.txt --mode test --ascii --max-depth 4 --filter SKIP

Stage 2

python3 config2/stage2.py --package Newtonsoft.Json --repo https://api.nuget.org/v3/index.json --mode real

Stage 3

python3 config2/stage3.py --package A --repo config2/repo.txt --max-depth 5 --filter SKIP

Stage 4

python3 config2/stage4.py --package A --repo config2/repo.txt --max-depth 10

Stage 5

python3 config2/stage5.py --repo config2/repo.txt --packages A B AA --ascii --max-depth 6

    Заключение

В ходе выполнения проекта была разработана полнофункциональная консольная система для анализа, построения и визуализации графа зависимостей программных пакетов. Работа разделена на пять самостоятельных этапов, каждый из которых вносит строго определённый объём функциональности и обеспечивает последовательное усложнение общей архитектуры инструмента. Такой подход позволил создать законченный программный продукт, соответствующий заявленным требованиям и демонстрирующий полный цикл обработки зависимостей: от считывания исходных данных до визуального представления результатов.

На первом этапе была сформирована основа приложения — модуль для чтения и проверки параметров конфигурации, позволяющий гибко управлять работой инструмента. Второй этап обеспечил корректный разбор входных данных и получение прямых зависимостей анализируемого пакета. На третьем этапе построен полноценный граф зависимостей, реализован алгоритм обхода в ширину с рекурсией, предусмотрены обработка циклов, ограничение глубины и фильтрация. Четвёртый этап расширил функциональность за счёт определения обратных зависимостей, что позволило анализировать связанные участки графа в противоположном направлении. На пятом этапе были разработаны механизмы визуализации — текстовое ASCII-дерево и генерация диаграмм в формате D2, что делает результаты анализа наглядными и удобными для дальнейшего использования.

Отдельное внимание в проекте уделено устойчивости алгоритмов: корректно обработаны сценарии циклических связей, некорректных данных, конфликтующих параметров и отсутствующих пакетов. Реализована структурированная архитектура, позволяющая расширять инструментарий без необходимости переработки базовых модулей. Использование исключительно стандартной библиотеки Python показало, что задачи подобного уровня могут быть решены без внешних зависимостей, при этом качество кода и функциональность остаются на высоком уровне.

В результате проект достиг всех поставленных целей. Разработан универсальный инструмент, способный считывать данные из тестового репозитория, строить граф зависимости любой глубины, выполнять прямой и обратный анализ, фильтровать результаты и формировать визуальные представления. Полученная система может использоваться как учебное средство, как вспомогательный инструмент в исследовательских задачах и как базовая платформа для последующего расширения в сторону реального пакетного менеджера.

Проект демонстрирует полное понимание принципов работы с графовыми структурами, алгоритмами обхода, методами визуализации и архитектурой программных систем. Полученный результат является завершённым, функциональным и соответствует требованиям задания.
